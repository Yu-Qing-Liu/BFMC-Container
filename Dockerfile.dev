FROM ad-acados:latest

WORKDIR /home/trtuser

ENV DEBIAN_FRONTEND=noninteractive

ENV QT_DEBUG_PLUGINS=1
ENV QT_QPA_PLATFORM=xcb

SHELL ["/bin/bash", "-c"]

################################
# Extra dependencies
################################
RUN apt-get update && apt-get install -y \
    nlohmann-json3-dev \
    libncurses5-dev \
    libncursesw5-dev

RUN pip uninstall -y PyQt5 && \
    apt-get install -y python3-pyqt5

################################
# .bashrc
################################
RUN echo "source /opt/ros/noetic/setup.bash" >> .bashrc
RUN echo 'export LD_LIBRARY_PATH=$LD_LIBRARY_PATH:"/home/trtuser/acados/lib"' >> .bashrc
RUN echo 'export ACADOS_SOURCE_DIR="/home/trtuser/acados"' >> .bashrc
